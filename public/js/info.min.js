parseArgs=function(){var a=location.search.substring(1);if(""===a)return{};a=a.split("&");var b={};for(parameter of a){var c=parameter.split("=");b[c[0]]=unescape(c[1])}return b},function(){var a={apiKey:"AIzaSyDgNzcJS-zqj-I3yUUXJp7EXp-6Vd6XsOo",authDomain:"boardex-b8a9e.firebaseapp.com",databaseURL:"https://boardex-b8a9e.firebaseio.com",storageBucket:"boardex-b8a9e.appspot.com",messagingSenderId:"762957983152"};firebase.initializeApp(a)}();const a=firebase.auth(),b=firebase.database();firebase.storage();!function(){Vue.use(VueFire);var c=b.ref("games"),d=b.ref("tagging"),e=b.ref("ratings"),f=function(a){c.child(a).remove().then(function(a){location.href="index.html"},function(a){"PERMISSION_DENIED"===a.code?alert("Error: You do not have permission to delete this game."):alert("Error: "+a.message)})};window.addEventListener("load",function(){args=parseArgs();var b=new Vue({el:"#game_info",data:{isUser:"",isOwner:"",isRating:"",game:"",formattedDesc:"",tags:[],newtag:"",rating:"",loginAlert:!1,funInput:"",diffInput:"",chaInput:""},created:function(){var a=c.child(args.t);a.once("value",a=>{null==a.val()&&(location.href="404.html"),this.game=a.val(),this.game.title=a.key,this.formattedDesc=marked(this.game.desc,{sanitize:!0}),this.checkOwnership()}),a.on("child_changed",a=>{this.game[a.key]=a.val()});var a=d.child("games/"+args.t);a.once("value",a=>{a.val()&&(b.tags=Object.keys(a.val()))});var f=e.child(args.t);f.once("value",a=>{this.rating=a.val(),this.rating.title=a.key}),f.on("child_changed",a=>{this.rating[a.key]=a.val()})},watch:{newtag:function(a,b){const c=this.tags.indexOf(a)<0,d=a&&c;d&&this.addTag(a),this.newtag=""}},methods:{updateGame:function(){console.log("updating"),console.log("redirecting to the edit page"),location.href="editgame.html?t="+this.game.title},deleteGame:function(){console.log("deleting"),confirm("Are you sure you want delete this game for good?")&&f(args.t)},checkOwnership:function(){a.onAuthStateChanged(a=>{this.isUser=null!=a,this.isOwner=null!=a&&a.uid===this.game.uid})},addTag:function(a){this.tags.push(a);var b={},c={};b[this.game.title]=!0,c[a]=!0;var e=d.child("tags/");e.child(a).update(b);var f=d.child("games/");f.child(this.game.title).update(c)},checkUser:function(){a.onAuthStateChanged(a=>{this.isRating=null!=a}),this.isRating||(this.loginAlert=!0)},saveRating:function(){console.log("FunInput: "+this.funInput),console.log("DiffInput: "+this.diffInput),this.isRating=!this.isRating;var a=parseInt(this.funInput)+parseInt(this.rating.funTotal),c=this.rating.funNum+1,d=parseInt(this.diffInput)+parseInt(this.rating.diffTotal),f=this.rating.diffNum+1,g=parseInt(this.chaInput)+parseInt(this.rating.chaTotal),h=this.rating.diffNum+1;console.log("newFunTotal: "+a),console.log("newFunNum: "+c),console.log("newDiffTotal: "+d),console.log("newDiffNum: "+f),this.funInput&&e.child(b.game.title).update({funRating:parseInt(a/c),funTotal:a,funNum:c}).then(function(a){console.log("rating saved succesfully")},function(a){console.log("rating failed")}),this.diffInput&&e.child(b.game.title).update({diffRating:parseInt(d/f),diffTotal:d,diffNum:f}).then(function(a){console.log("rating saved succesfully")},function(a){console.log("rating failed")}),this.chaInput&&e.child(b.game.title).update({chaRating:parseInt(g/h),chaTotal:g,chaNum:h}).then(function(a){console.log("rating saved succesfully")},function(a){console.log("rating failed")})}}})})}(),function(){Vue.use(VueFire);const a=3;var c=b.ref("games");new Vue({el:"#recommend_list",data:{games:[]},created:function(){var b=c.orderByKey().limitToLast(a);b.on("child_added",a=>{var b=a.val();b.title=a.key,this.games.push(b)})}})}(),function(){const b=document.getElementById("signup"),c=document.getElementById("signin"),d=document.getElementById("signout");d.addEventListener("click",b=>{a.signOut(),alert("You have succesfully signed out.")}),a.onAuthStateChanged(a=>{a?(console.log(a),console.log("logged in"),b.classList.add("hide"),c.classList.add("hide"),d.classList.remove("hide")):(console.log("not logged in"),b.classList.remove("hide"),c.classList.remove("hide"),d.classList.add("hide"))})}(),function(){Vue.use(VueFire);var a=b.ref("games");new Vue({el:"#searchbar",data:{searchString:"",gamesList:[],loadedGamesList:[],displayList:[],isSearch:!1},created:function(){a.on("value",a=>{let b=[];a.forEach(a=>{b.push(a.key)}),this.gamesList=b,this.loadedGamesList=b})},methods:{initializeItems:function(){this.gamesList=this.loadedGamesList},search:function(){var a=this.searchString;return this.isSearch=!0,this.initializeItems(),a?(a=a.trim().toLowerCase(),this.gamesList=this.gamesList.filter(b=>{if(a)return b.toLowerCase().indexOf(a)>-1}),void console.log("final list: "+this.gamesList)):void(this.isSearch=!1)},submitSearch:function(){location.href="info.html?t="+this.gamesList[0]}}})}();